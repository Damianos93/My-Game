class Emperor {
    constructor(position) {
        this.emperorP;
        this.moveEmperor = this.moveEmperor.bind(this)
    }
    moveEmperor(event) {
        switch (event.key) {
            case "ArrowUp":
                event.preventDefault()
                moveUp(this.emperorP)
                break;
            case "ArrowDown":
                event.preventDefault()
                moveDown(this.emperorP)
                break;
            case " ":
                event.preventDefault()
                this.throwLightning()
                break;
            default:
                break;
        }
    }

    render() {
        this.emperorP = document.createElement("img")
        this.emperorP.src = "./images/emperoris.gif"
        let gameArea = document.getElementById("gameArea")
        this.emperorP.style.position = "fixed"
        this.emperorP.style.left = "88rem";
        gameArea.append(this.emperorP)
    }

    throwLightning() {
        let light = this.createLightElement()
        gameArea.appendChild(light)
        let lightThrow = new Audio('./music/wooooosh.wav')
        lightThrow.play()
        this.moveLightning(light)
        // cookieThrow.pause()
    }


    createLightElement() {
        let xPosition = parseInt(window.getComputedStyle(this.emperorP).getPropertyValue('right'))
        let yPosition = parseInt(window.getComputedStyle(this.emperorP).getPropertyValue('top'))
        let newLight = document.createElement('img')
        newLight.src = './images/lights.gif'
        newLight.classList.add('light')
        newLight.style.right = `${xPosition}px`
        newLight.style.top = `${yPosition + 40}px`
        return newLight;
    }

    moveLightning(light) {
        let lightInterval = setInterval(() => {
            let xPosition = parseInt(light.style.right)
            if (xPosition === window.innerWidth) {
                light.remove()
                clearInterval(lightInterval)
            } else {
                light.style.right = `${xPosition + 4}px`
            }
            if (isTouching(light, game.myVader.vaderP)) {
                alert("Zapped B..a12!@12421tch")
                light.remove()
            }
        }, 1)
    }

    moveUp(person) {
        let topPosition = window.getComputedStyle(person).getPropertyValue('top')
        if (person.style.top === "0px") {
            return
        } else {
            if (person === game.vader) {
                let position = parseInt(topPosition)
                position -= 17
                person.style.top = `${position}px`
            }
            else {
                let position = parseInt(topPosition)
                position -= 30
                person.style.top = `${position}px`
            }
        }
    }

    moveDown(person) {
        let topPosition = window.getComputedStyle(person).getPropertyValue('top')
        if ((fromPxToNumber(person.style.top) + person.height) >= window.innerHeight) {
            position = 0;
            person.style.top = `${position}px`
            return
        } else {
            if (person === vader) {
                let position = parseInt(topPosition)
                position += 17
                person.style.top = `${position}px`
            }
            else {
                let position = parseInt(topPosition)
                position += 35
                person.style.top = `${position}px`
            }
        }
    }
    fromPxToNumber(pixel) {
        return parseInt(pixel.split("px")[0])
    }
}
